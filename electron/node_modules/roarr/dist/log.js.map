{"version":3,"sources":["../src/log.js"],"names":["globalThis","ROARR","logFactory","createLogger","environmentIsNode","enabled","process","env","ROARR_LOG","createMockLogger","message","write","body","JSON","stringify"],"mappings":";;;;;;;AAEA;;AAGA;;AACA;;AACA;;;;AAMA,MAAMA,UAAU,GAAG,0BAAnB;AAEAA,UAAU,CAACC,KAAX,GAAmB,gDAAgCD,UAAU,CAACC,KAAX,IAAoB,EAApD,CAAnB;AAEA,IAAIC,UAAU,GAAGC,uBAAjB;;AAEA,IAAIC,mBAAJ,EAAuB;AACrB;AACA,QAAMC,OAAO,GAAG,sBAAQC,OAAO,CAACC,GAAR,CAAYC,SAAZ,IAAyB,EAAjC,CAAhB;;AAEA,MAAI,CAACH,OAAL,EAAc;AACZH,IAAAA,UAAU,GAAGO,2BAAb;AACD;AACF;;eAQcP,UAAU,CAAEQ,OAAD,IAAa;AACrC,MAAIV,UAAU,CAACC,KAAX,CAAiBU,KAArB,EAA4B;AAC1B;AACA;AACA,UAAMC,IAAI,GAAGC,IAAI,CAACC,SAAL,CAAeJ,OAAf,CAAb;AAEAV,IAAAA,UAAU,CAACC,KAAX,CAAiBU,KAAjB,CAAuBC,IAAvB;AACD;AACF,CARwB,C","sourcesContent":["// @flow\n\nimport {\n  boolean,\n} from 'boolean';\nimport createGlobalThis from 'globalthis';\nimport environmentIsNode from 'detect-node';\nimport {\n  createLogger,\n  createMockLogger,\n  createRoarrInititialGlobalState,\n} from './factories';\n\nconst globalThis = createGlobalThis();\n\nglobalThis.ROARR = createRoarrInititialGlobalState(globalThis.ROARR || {});\n\nlet logFactory = createLogger;\n\nif (environmentIsNode) {\n  // eslint-disable-next-line no-process-env\n  const enabled = boolean(process.env.ROARR_LOG || '');\n\n  if (!enabled) {\n    logFactory = createMockLogger;\n  }\n}\n\nexport type {\n  LoggerType,\n  MessageType,\n  TranslateMessageFunctionType,\n} from './types';\n\nexport default logFactory((message) => {\n  if (globalThis.ROARR.write) {\n    // Stringify message as soon as it is received to prevent\n    // properties of the context from being modified by reference.\n    const body = JSON.stringify(message);\n\n    globalThis.ROARR.write(body);\n  }\n});\n"],"file":"log.js"}